"use strict";angular.module("ticTacToeApp",["ngAnimate","ngAria","ngCookies","ngMessages","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"mainCtrl",controllerAs:"main"}).when("/play",{templateUrl:"views/play.html",controller:"gameCtrl",controllerAs:"game"}).otherwise({redirectTo:"/"})}]).service("MoveService",function(){function a(a){for(var b=[],c=0;c<a.length;c++)""==a[c]&&b.push(c);return b}this.huPlayer,this.aiPlayer,this.minimax=function(b,c){var d=a(b);if(this.winning(b,this.huPlayer))return{score:-10};if(this.winning(b,this.aiPlayer))return{score:10};if(0===d.length)return{score:0};for(var e=[],f=0;f<d.length;f++){var g={};g.index=d[f],b[d[f]]=c;var h;c==this.aiPlayer?(h=this.minimax(b,this.huPlayer),g.score=h.score):(h=this.minimax(b,this.aiPlayer),g.score=h.score),b[d[f]]="",e.push(g)}var i;if(c===this.aiPlayer)for(var j=-1e4,f=0;f<e.length;f++)e[f].score>j&&(j=e[f].score,i=f);else for(var j=1e4,f=0;f<e.length;f++)e[f].score<j&&(j=e[f].score,i=f);return e[i]},this.winning=function(a,b){return a[0]==b&&a[1]==b&&a[2]==b||a[3]==b&&a[4]==b&&a[5]==b||a[6]==b&&a[7]==b&&a[8]==b||a[0]==b&&a[3]==b&&a[6]==b||a[1]==b&&a[4]==b&&a[7]==b||a[2]==b&&a[5]==b&&a[8]==b||a[0]==b&&a[4]==b&&a[8]==b||a[2]==b&&a[4]==b&&a[6]==b?!0:!1}}),angular.module("ticTacToeApp").controller("mainCtrl",["MoveService","$scope","$location",function(a,b,c){b.setHumanPlayer=function(b){a.huPlayer=b,a.aiPlayer="X"==b?"O":"X",c.path("play")}}]),angular.module("ticTacToeApp").controller("gameCtrl",["MoveService","$scope","$location",function(a,b,c){function d(){if(b.currentPlayer==a.huPlayer)setTimeout(d,0);else{var c=e();h(),console.log(a.aiPlayer+" to "+c.index),b.currentPlayer="X"==b.currentPlayer?"O":"X";var j=g(5,13);setTimeout(function(){void 0==c.index?(b.turnText="Game Over! Result: Tie",b.ties++):b.gameBoard[c.index]=a.aiPlayer,b.isHumanTurn=1,i(),f()},100*j),setTimeout(d,0)}}function e(){return a.minimax(b.gameBoard,b.currentPlayer)}function f(){if(a.winning(b.gameBoard,"O")||a.winning(b.gameBoard,"X")){b.turnText="Game Over! Result: Loss",b.losses++;for(var c=0;9>c;c++)""==b.gameBoard[c]&&(b.gameBoard[c]=" ")}b.$$phase||b.$digest()}function g(a,b){return a=Math.ceil(a),b=Math.floor(b),Math.floor(Math.random()*(b-a))+a}function h(){for(var a=0;9>a;a++)""==b.gameBoard[a]&&(b.gameBoard[a]=" ");b.$$phase||b.$digest()}function i(){for(var a=0;9>a;a++)" "==b.gameBoard[a]&&(b.gameBoard[a]="");b.$$phase||b.$digest()}b.gameBoard=["","","","","","","","",""],b.currentPlayer=a.huPlayer,b.turnText="Your move!",b.isHumanTurn=b.currentPlayer==a.huPlayer?1:0,b.wins=0,b.ties=0,b.losses=0,void 0==a.huPlayer&&void 0==a.aiPlayer&&c.path("/"),d(),b.play=function(a){b.gameBoard[3*a.row+a.col]=a.player,b.currentPlayer="X"==b.currentPlayer?"O":"X",b.isHumanTurn=0},b.restart=function(){b.gameBoard=["","","","","","","","",""],b.currentPlayer=a.huPlayer,b.turnText="Your move!",b.isHumanTurn=b.currentPlayer==a.huPlayer?1:0},b.back=function(){c.path("/")}}]),angular.module("ticTacToeApp").run(["$templateCache",function(a){a.put("views/about.html",'<div class="centered"> <table class="board"> <tr ng-repeat="i in [0, 1, 2]"> <td ng-repeat="j in [0, 1, 2]"> <button class="btn btn-default square" ng-click="play({\'player\':cp, \'row\': i, \'col\':j})" ng-disabled="fill[i][j] != \'\'">{{fill[i][j]}}</button> </td> </tr> </table> </div>'),a.put("views/main.html",'<div class="row" align="center"> <div class="col-md-4 col-md-offset-4" align="center"> <h3> Choose your piece. </h3> <button type="button" class="btn btn-primary btn-lg menu-button" ng-click="setHumanPlayer(\'X\')">X</button> <button type="button" class="btn btn-danger btn-lg menu-button" ng-click="setHumanPlayer(\'O\')">O</button> </div> </div>'),a.put("views/play.html",'<div class="row" align="center"> <div class="col-md-4 col-md-offset-4" align="center"> <table class="board"> <tr ng-repeat="i in [0, 1, 2]"> <td ng-repeat="j in [0, 1, 2]"> <button class="btn btn-default square" ng-click="play({\'player\':currentPlayer, \'row\': i, \'col\':j})" ng-disabled="gameBoard[i * 3 + j] != \'\'" ng-bind="gameBoard[i * 3 + j]"></button> </td> </tr> </table> <h2><span class="label label-default" style="margin-top: 100px" ng-bind="turnText" ng-show="isHumanTurn"></span></h2> <img class="center" src="./images/loader.a9aed0fd.gif" ng-show="!isHumanTurn"> <h4>Record (W/T/L): {{wins}}/{{ties}}/{{losses}} </h4> <button type="button" class="btn btn-success btn-lg menu-button-small" ng-click="restart()">Restart</button> <button type="button" class="btn btn-danger btn-lg menu-button-small" ng-click="back()">Back</button> </div> </div>')}]);